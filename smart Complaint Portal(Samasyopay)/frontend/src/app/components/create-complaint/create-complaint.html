<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Header -->
      <div class="d-flex align-items-center mb-4">
        <button class="btn btn-outline-secondary me-3" (click)="goBack()">
          <i class="bi bi-arrow-left"></i>
        </button>
        <div>
          <h2 class="fw-bold mb-1">Create New Complaint</h2>
          <p class="text-muted mb-0">Submit your complaint and we'll help resolve it</p>
        </div>
      </div>

      <!-- Form Card -->
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <form (ngSubmit)="onSubmit()" #complaintForm="ngForm">
            <!-- Title -->
            <div class="mb-3">
              <label for="title" class="form-label fw-semibold">Complaint Title *</label>
              <input 
                type="text" 
                class="form-control" 
                id="title" 
                name="title"
                [(ngModel)]="complaintData.title" 
                required 
                #title="ngModel"
                placeholder="Enter a brief title for your complaint"
                maxlength="200">
              <div *ngIf="title.invalid && title.touched" class="text-danger small mt-1">
                Title is required
              </div>
              <div class="form-text">{{ complaintData.title.length }}/200 characters</div>
            </div>

            <!-- Complaint Type -->
            <div class="mb-3">
              <label for="complaintType" class="form-label fw-semibold">Complaint Type *</label>
              <select 
                class="form-select" 
                id="complaintType" 
                name="complaintType"
                [(ngModel)]="complaintData.complaintTypeId" 
                required 
                #complaintType="ngModel">
                <option value="0">Select complaint type</option>
                <option *ngFor="let type of complaintTypes" [value]="type.id">
                  {{ type.name }}
                </option>
              </select>
              <div *ngIf="complaintType.invalid && complaintType.touched" class="text-danger small mt-1">
                Please select a complaint type
              </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label fw-semibold">Description *</label>
              <textarea 
                class="form-control" 
                id="description" 
                name="description"
                [(ngModel)]="complaintData.description" 
                required 
                #description="ngModel"
                rows="5"
                placeholder="Provide detailed information about your complaint"
                maxlength="1000"></textarea>
              <div *ngIf="description.invalid && description.touched" class="text-danger small mt-1">
                Description is required
              </div>
              <div class="form-text">{{ complaintData.description.length }}/1000 characters</div>
            </div>

            <!-- File Upload -->
            <div class="mb-4">
              <label for="documents" class="form-label fw-semibold">Supporting Documents</label>
              <input 
                type="file" 
                class="form-control" 
                id="documents" 
                multiple
                accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                (change)="onFileSelect($event)">
              <div class="form-text">Upload supporting documents (PDF, DOC, DOCX, JPG, PNG). Max 5MB per file.</div>
              
              <!-- Selected Files -->
              <div *ngIf="selectedFiles.length > 0" class="mt-3">
                <h6 class="fw-semibold mb-2">Selected Files:</h6>
                <div class="d-flex flex-wrap gap-2">
                  <div *ngFor="let file of selectedFiles; let i = index" 
                       class="badge bg-light text-dark d-flex align-items-center">
                    <i class="bi bi-file-earmark me-1"></i>
                    <span class="me-2">{{ file.name }}</span>
                    <button type="button" class="btn-close btn-close-sm" 
                            (click)="removeFile(i)" aria-label="Remove file"></button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Error/Success Messages -->
            <div *ngIf="error" class="alert alert-danger" role="alert">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ error }}
            </div>

            <div *ngIf="success" class="alert alert-success" role="alert">
              <i class="bi bi-check-circle-fill me-2"></i>{{ success }}
            </div>

            <!-- Action Buttons -->
            <div class="d-flex gap-2">
              <button 
                type="submit" 
                class="btn btn-primary"
                [disabled]="loading || complaintForm.invalid">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                {{ loading ? 'Submitting...' : 'Submit Complaint' }}
              </button>
              <button type="button" class="btn btn-outline-secondary" (click)="goBack()">
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Help Text -->
      <div class="card border-0 bg-light mt-4">
        <div class="card-body">
          <h6 class="fw-semibold mb-2"><i class="bi bi-info-circle me-2"></i>Tips for Better Complaints</h6>
          <ul class="mb-0 small text-muted">
            <li>Be specific and clear in your description</li>
            <li>Include relevant dates, locations, and people involved</li>
            <li>Attach supporting documents or photos if available</li>
            <li>Choose the most appropriate complaint type</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
